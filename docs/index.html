<div class="grid grid-cols-2 gap-4">
  <!-- 左上：指標觀察清單 -->
  <div class="p-4 border rounded">
    <h3>指標觀察清單</h3>
    <ul id="insights-list"></ul>
  </div>

  <!-- 右上：新上榜 -->
  <div class="p-4 border rounded">
    <h3>新上榜 (近10日首次進榜)</h3>
    <ul id="newcomers-list"></ul>
  </div>
</div>

<!-- 搜尋框 -->
<div class="my-4">
  <label>輸入股票代碼或名稱：</label>
  <input type="text" id="search-input" placeholder="台燿 (6274)">
</div>

<!-- 買賣超紀錄 -->
<table id="trading-table" class="table-auto w-full text-center border-collapse border">
  <thead>
    <tr>
      <th>日期</th>
      <th>外資 (張)</th>
      <th>投信 (張)</th>
      <th>自營商 (張)</th>
      <th>三大法人合計 (張)</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<!-- EPS 折線圖 -->
<canvas id="epsChart"></canvas>

<script>
// 指標觀察清單
fetch("docs/insights.json")
  .then(res => res.json())
  .then(data => {
    const list = document.getElementById("insights-list");
    list.innerHTML = "";
    data.insights.forEach(item => {
      const li = document.createElement("li");
      li.textContent = item;
      list.appendChild(li);
    });
  });

// 新上榜
fetch("docs/newcomers.json")
  .then(res => res.json())
  .then(data => {
    const list = document.getElementById("newcomers-list");
    list.innerHTML = "";
    data.newcomers.forEach(stock => {
      const li = document.createElement("li");
      li.textContent = `${stock.name} (${stock.stock_id})`;
      list.appendChild(li);
    });
  });

// 搜尋 + 買賣超
let records = [];
fetch("docs/data.json")
  .then(res => res.json())
  .then(data => records = data.records);

document.getElementById("search-input").addEventListener("input", e => {
  const keyword = e.target.value.trim();
  const tbody = document.querySelector("#trading-table tbody");
  tbody.innerHTML = "";

  if (!keyword) return;

  records.forEach(day => {
    day.stocks.forEach(stock => {
      if (stock.name.includes(keyword) || stock.stock_id === keyword.replace(/\D/g, "")) {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${day.date}</td>
          <td class="${stock.foreign_net > 0 ? 'text-red-500' : 'text-green-500'}">${stock.foreign_net}</td>
          <td>${stock.invest_net}</td>
          <td>${stock.dealer_net || 0}</td>
          <td>${stock.foreign_net + stock.invest_net + (stock.dealer_net || 0)}</td>
        `;
        tbody.appendChild(tr);
      }
    });
  });
});

// EPS Chart.js 保持你現有版本
</script>
