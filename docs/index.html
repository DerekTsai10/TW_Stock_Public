<script>
// é¡¯ç¤º EPS æŠ˜ç·šåœ–
function renderEPS(stockId) {
  fetch("eps.json")
    .then(res => res.json())
    .then(data => {
      const key = String(stockId).trim();   // ç¢ºä¿æ˜¯å­—ä¸²
      console.log("ðŸ” æŸ¥è©¢ stockId:", stockId, "â†’ key:", key);
      console.log("ðŸ“‚ eps.json keys:", Object.keys(data));

      const epsData = data[key];
      const ctx = document.getElementById("epsChart").getContext("2d");

      if (!epsData || epsData.length === 0) {
        if (window.epsChart) window.epsChart.destroy(); // æ¸…æŽ‰èˆŠåœ–
        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
        ctx.font = "16px Arial";
        ctx.fillText("æŸ¥ç„¡ EPS è³‡æ–™", 10, 50);
        return;
      }

      const labels = epsData.map(e => e.date).reverse();
      const values = epsData.map(e => e.eps).reverse();

      if (window.epsChart) window.epsChart.destroy();

      window.epsChart = new Chart(ctx, {
        type: "line",
        data: {
          labels: labels,
          datasets: [{
            label: "EPS",
            data: values,
            borderColor: "blue",
            backgroundColor: "rgba(0,0,255,0.1)",
            fill: true,
            tension: 0.2
          }]
        },
        options: {
          responsive: true,
          scales: {
            y: { beginAtZero: true }
          }
        }
      });
    });
}
</script>
